<!doctype html>
<html lang="en">

<head>
	<title>Home</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<!-- VENDOR CSS -->
	<link rel="stylesheet" href="assets/vendor/bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" href="assets/vendor/font-awesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="assets/vendor/linearicons/style.css">
	<link rel="stylesheet" href="assets/vendor/chartist/css/chartist-custom.css">
	<!-- MAIN CSS -->
	<link rel="stylesheet" href="assets/css/main.css">
	<!-- FOR DEMO PURPOSES ONLY. You should remove this in your project -->
	<link rel="stylesheet" href="assets/css/demo.css">
	<!-- GOOGLE FONTS -->
	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700" rel="stylesheet">
	<!-- ICONS -->
	<link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png">
	<link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicon.png">
	<script src="assets/scripts/echarts.min.js"></script>
	<script src="assets/vendor/jquery/jquery.min.js"></script>
</head>

<body>
	<!-- WRAPPER -->
	<div id="wrapper">
		<!-- NAVBAR -->
		<nav class="navbar navbar-default navbar-fixed-top">
			<div class="brand">
				<a href="index.html"><img src="assets/img/logo.png" alt="Klorofil Logo" class="img-responsive logo"></a>
			</div>
			<div class="container-fluid">
				<div class="navbar-btn">
					<button type="button" class="btn-toggle-fullwidth"><i class="lnr lnr-arrow-left-circle"></i></button>
				</div>
				<form class="navbar-form navbar-left">
					<div class="input-group">
						
					</div>
				</form>
				<div class="navbar-btn navbar-btn-right">
					
				</div>
				<div id="navbar-menu">
					<h1>Reptiler免费爬虫平台</h1>
				</div>
			</div>
		</nav>
		<!-- END NAVBAR -->
		<!-- LEFT SIDEBAR -->
		<div id="sidebar-nav" class="sidebar">
			<div class="sidebar-scroll">
				<nav>
					<ul class="nav">
						<li><a href="index.html" class=""><i class="lnr lnr-home"></i> <span>房产信息</span></a></li>
						<li><a href="allgoods.html" class=""><i class="lnr lnr-cart"></i> <span>二手市场</span></a></li>
						<li><a href="#" class="active"><i class="fa fa-line-chart"></i> <span>商品统计</span></a></li>
						
					</ul>
				</nav>
			</div>
		</div>
		<!-- END LEFT SIDEBAR -->
		<!-- MAIN -->
		<div class="main">
			<!-- MAIN CONTENT -->
			<div class="main-content">
				<div class="container-fluid">
					<!-- OVERVIEW -->
					<div class="panel panel-headline">
						<div class="panel-heading">
							<h3 class="panel-title"></h3>
						</div>
						<div class="panel-body">
							<div class="row">
								<div class="col-md-9">
									<div id="mapChart" style="width: 800px;height:600px;"></div>
								</div>
								
							</div>
							<table class="table table-striped">
										<thead>
											<tr>
												<th>名称</th>
												<th>联系人</th>
												<th>区域</th>
												<th>售价</th>
												<th>浏览量</th>
												<th>想买</th>
											</tr>
										</thead>
										<tbody id="tbody">
											<tr>
												<td width="350px"></td>
											</tr>
										</tbody>
									</table>
									<table class="table table-striped">
										<tr style="float:center;">
											<td>
												<a href="#" class="btn btn-default" onclick="refreshTable('first');">首页</a> 
												<a href="#"class="btn btn-default" onclick="refreshTable('previous')">上一页</a>
											</td>
											<td>
												<a href="#" class="btn btn-default" id="pagenum"></a>
											</td>
											<td>
												<a href="" class="btn btn-default" onclick="refreshTable('jump')">跳转到</a>
												<input type="text" id="page" name="page" width="5px"><a href="#" class="btn btn-default">页</a>
											</td>
											<td>
												<a href="#" class="btn btn-default" id="c_num"></a>
											</td>
											<td>
												<a href="#" class="btn btn-default" onclick="refreshTable('last')">尾页</a> 
												<a href=""class="btn btn-default" onclick="refreshTable('next')">下一页</a>
											</td>
										</tr>
									</table>
						</div>
					</div>
				</div>
			</div>
			<!-- END MAIN CONTENT -->
		</div>
		<!-- END MAIN -->
		<div class="clearfix"></div>
		<footer>
			<div class="container-fluid">
				<p class="copyright">Copyright &copy; 2017.青青草原不吃羊</p>
			</div>
		</footer>
	</div>
	<!-- END WRAPPER -->
	<!-- Javascript -->
	<script src="assets/vendor/jquery/jquery.min.js"></script>
	<script src="assets/vendor/bootstrap/js/bootstrap.min.js"></script>
	<script src="assets/vendor/jquery-slimscroll/jquery.slimscroll.min.js"></script>
	<script src="assets/vendor/jquery.easy-pie-chart/jquery.easypiechart.min.js"></script>
	<script src="assets/vendor/jquery-cookie/jquery.cookie.js"></script>
	<script src="assets/vendor/chartist/js/chartist.min.js"></script>
	<script src="assets/scripts/klorofil-common.js"></script>
	<script type="text/javascript">
		var data1 = '哈哈哈';
		var type='';
		var href=location.search;
		var Request = new Object();
		if(href.indexOf("?")!=-1)
		{
 			var str = href.substr(1); //去掉?号
 			strs = str.toLowerCase();
 			strs = strs.split("&");
 			for(var i=0;i<strs.length;i++)
 			{
  				Request[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1]);
 			}
		}
		type = Request["type"];
		alert(type);
		if(type!=null && type!='' && type!=undefined)
		{
			$.cookie("type",type);
		}
		if(type==null || type=='' || type==undefined)
		{
			alert("kkkkkkk");
			type = $.cookie("type");
		}
		//获取url
		var url = $.cookie("url");
		$.cookie("url",null);
		if(url==''|| url=='null')
		{
			url = "getGoodDetail?table=saledetaildata2&type="+type+"&page=1";
		}
		url = encodeURI(url);
	    url = encodeURI(url);
		
		//获取系统时间
        var date = new Date();
        var seperator = "-";
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var strDate = date.getDate();
        if (month >= 1 && month <= 9) {
            month = "0" + month;
        }
        if (strDate >= 0 && strDate <= 9) {
            strDate = "0" + strDate;
        }
        var currentdate = year + seperator + month + seperator + strDate;
        
        var tbody='';
        var page=1;
        var count=1;
        var pagenum='';
        var countnum='';
        
     	$(document).ready(load);
     		function load(){
     		$.ajax({
     			type:"Post",
     			async: false,
             	url: url,
                dataType: "json",
             	success: function(json){
             		$.each( json['detail'], function(i,n){  
             			var url = n.url!='undefined'?n.url:0;
             			var name = n.name!='undefined'?n.name:0;
             			var lxr = n.lxr!='undefined'?n.lxr:0;
             			var qy = n.qy!='undefined'?n.qy:0;
             			var sj = n.xj!='undefined'?n.xj:0;
             			var lxr = n.lxr!='undefined'?n.lxr:0;
             			var llcs = n.llcs!='undefined'?n.llcs:0;
             			var xmrs = n.xmrs!='undefined'?n.xmrs:0;
             			page = n.page!='undefined'?n.page:0;
             			count =  n.count!='undefined'?n.count:0;
             			tbody = tbody + "<tr><td><a href=\""+url+"\">"+name+"</a></td>"
             						  +"<td>"+lxr+"</td>"
             						  +"<td>"+qy+"</td>"
             						  +"<td>"+sj+"</td>"
             						  +"<td>"+llcs+"</td>"
             						  +"<td>"+xmrs+"</td>"
             			
             		});
             		pagenum = "<a>第"+page+"页</a>";
             		countnum = "<a>共"+count+"页</a>";
             		$("#tbody").append(tbody);
             		$("#pagenum").append(pagenum);
             		$("#c_num").append(countnum);
                },
     			error: function(){
     				alert('fail');
     			}
     		});
     	}
     </script>
     <script type="text/javascript">
        // 基于准备好的dom，初始化echarts实例
        var mapChart = echarts.init(document.getElementById('mapChart'));
     	option = {
    title : {
        text: type+'价格分布',
        subtext: '纯属虚构',
        x:'center'
    },
    tooltip : {
        trigger: 'item',
        formatter: "{a} <br/>{b} : {c} ({d}%)"
    },
    legend: {
        orient: 'vertical',
        left: 'left',
        data: [data1,'邮件营销','联盟广告','视频广告','搜索引擎']
    },
    series : [
        {
            name: '访问来源',
            type: 'pie',
            radius : '55%',
            center: ['50%', '60%'],
            data:[
                {value:335, name:data1},
                {value:310, name:'邮件营销'},
                {value:234, name:'联盟广告'},
                {value:135, name:'视频广告'},
                {value:1548, name:'搜索引擎'}
            ],
            itemStyle: {
                emphasis: {
                    shadowBlur: 10,
                    shadowOffsetX: 0,
                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                }
            }
        }
    ]
};
     	
        // 使用刚指定的配置项和数据显示图表。
       mapChart.setOption(option);
    </script>
	<script type="text/javascript">
    	function refreshTable(sign)
    	{
    		
    		if(sign=='first')
    		{
    			url = "getGoodDetail?table=saledetaildata2&type="+type+"&page=1";
    		}
    		if(sign=='last')
    		{
    			url= "getGoodDetail?table=saledetaildata2&type="+type+"&page=last";
    		}
    		if(sign=='previous')
    		{
    			page = page-1;
    			if(page==0)
    			{
    				page=1;
    			}
    			url="getGoodDetail?table=saledetaildata2&type="+type+"&page="+page;
    		}
    		if(sign=='next')
    		{
    			page = parseInt(page) + 1;
    			if(parseInt(page)>parseInt(count))
    			{
    				page='last';
    			}
    			url="getGoodDetail?table=saledetaildata2&type="+type+"&page="+page;
    			alert(url);
    		}
    		if(sign=='jump')
    		{
    			page = $("#page").val();
    			if(parseInt(page)<1)
    			{	page = 1;
    			}
    			if(parseInt(page)>parseInt(count))
    			{
    				page='last';
    			}
    			url="getGoodDetail?table=saledetaildata2&type="+type+"&page="+page;
    		}
    		$.cookie("url",url);
    		window.location.href='detail.html';
    	}
    </script>
</body>

</html>
